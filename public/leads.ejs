<!DOCTYPE html>

<html
  lang="en"
  class=""
  dir="ltr"
  data-skin="default"
  data-assets-path="assets/"
  data-template="vertical-menu-template"
  data-bs-theme="dark"
>
  <head>

   
    <link rel="stylesheet" href="assets/vendor/css/core.css" />
    <link rel="stylesheet" href="assets/css/demo.css" />


    <!-- endbuild -->

    <link
      rel="stylesheet"
      href="assets/vendor/libs/jkanban/jkanban.css"
    />
    <link
      rel="stylesheet"
      href="assets/vendor/libs/select2/select2.css"
    />
    <link
      rel="stylesheet"
      href="assets/vendor/libs/flatpickr/flatpickr.css"
    />

    <link rel="stylesheet" href="assets/vendor/libs/quill/katex.css" />
    <link rel="stylesheet" href="assets/vendor/libs/quill/editor.css" />

    <!-- Page CSS -->

    <link
      rel="stylesheet"
      href="assets/vendor/css/pages/app-kanban.css"
    />
    <link rel="stylesheet" href="assets/css/vendor/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/vendor/animate.css">
    <link rel="stylesheet" href="assets/css/plugins/apexcharts.css">
    <link rel="stylesheet" href="assets/css/plugins/jquery-jvectormap-2.0.5.css">
    <link rel="stylesheet" href="assets/css/plugins/swiper-bundle.min.css">
    <link rel="stylesheet" href="assets/css/vendor/magnific-popup.css">
    <link rel="stylesheet" href="assets/css/vendor/icomoon.css">
    <link rel="stylesheet" href="assets/css/vendor/fontawesome-pro.css">
    <link rel="stylesheet" href="assets/css/vendor/rating.css">
    <link rel="stylesheet" href="assets/css/vendor/dropzone.css">
    <link rel="stylesheet" href="assets/css/plugins/dropify.min.css">
    <link rel="stylesheet" href="assets/css/vendor/spacing.css">
    <link rel="stylesheet" href="assets/css/plugins/datatables.min.css">
    <link rel="stylesheet" href="assets/css/plugins/buttons.bootstrap5.css">
    <link rel="stylesheet" href="assets/css/plugins/jquery.dataTables.min.css">
    <link rel="stylesheet" href="assets/css/plugins/select2.min.css">
    <link rel="stylesheet" href="assets/css/plugins/jquery.timepicker.css">
    <link rel="stylesheet" href="assets/css/plugins/tagify.css">
    <link rel="stylesheet" href="assets/css/plugins/flatpickr.min.css">
    <link rel="stylesheet" href="assets/css/plugins/jquery-ui.css">
    <link rel="stylesheet" href="assets/css/plugins/fullcalendar.min.css">
    <link rel="stylesheet" href="assets/css/plugins/ion.rangeSlider.min.css">
    <link rel="stylesheet" href="assets/css/plugins/simplebar.css">
    <link rel="stylesheet" href="assets/css/plugins/waves.min.css">
    <link rel="stylesheet" href="assets/css/plugins/nano.min.css">
    <link rel="stylesheet" href="assets/css/main.css">

  
  </head>

  <body class="body-area">
    <div class="preloader" id="preloader">
      <div class="loading">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
      </div>
  </div>

  <div class="page__full-wrapper">

    <%- include('sideNavBar') %>
    <div class="app__offcanvas-overlay"></div>

    <div class="page__body-wrapper">
      <!-- App header area start -->
      <%- include('header') %>
      <div class="body__overlay"></div>

    <div class="layout-wrapper layout-content-navbar">
      <div class="layout-container">
        <!-- Menu -->


        <div class="menu-mobile-toggler d-xl-none rounded-1">
          <a
            href="javascript:void(0);"
            class="layout-menu-toggle menu-link text-large text-bg-secondary p-2 rounded-1"
          >
            <i class="bx bx-menu icon-base"></i>
            <i class="bx bx-chevron-right icon-base"></i>
          </a>
        </div>
        <!-- / Menu -->

        <!-- Layout container -->
        <div class="layout-page">
          <!-- Navbar -->
          <!-- / Navbar -->

          <!-- Content wrapper -->
          <div class="content-wrapper">
            <!-- Content -->
            <div class="container-xxl flex-grow-1 container-p-y">
              <div class="app-kanban">
                <!-- Add new board -->
                <div class="row">
                  <div class="col-12">
                    <form class="kanban-add-new-board">
                      <label
                        class="kanban-add-board-btn"
                        for="kanban-add-board-input"
                      >
                        <i class="icon-base bx bx-plus"></i>
                        <span class="align-middle">Add new</span>
                      </label>
                      <input
                        type="text"
                        class="form-control w-px-250 kanban-add-board-input mb-4 d-none"
                        placeholder="Add Board Title"
                        id="kanban-add-board-input"
                        required
                      />
                      <div class="mb-4 kanban-add-board-input d-none">
                        <button class="btn btn-primary btn-sm me-3">Add</button>
                        <button
                          type="button"
                          class="btn btn-label-secondary btn-sm kanban-add-board-cancel-btn"
                        >
                          Cancel
                        </button>
                      </div>
                    </form>
                  </div>
                </div>

                <!-- Kanban Wrapper -->
                <div class="kanban-wrapper"></div>

                <!-- Edit Task/Task & Activities -->
                <div class="offcanvas offcanvas-end kanban-update-item-sidebar">
                  <div class="offcanvas-header border-bottom">
                    <h5 class="offcanvas-title">Edit Task</h5>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="offcanvas"
                      aria-label="Close"
                    ></button>
                  </div>
                  <div class="offcanvas-body pt-0">
                    <div class="nav-align-top">
                      <ul class="nav nav-tabs mb-6 rounded-0">
                        <li class="nav-item">
                          <button
                            class="nav-link active"
                            data-bs-toggle="tab"
                            data-bs-target="#tab-update"
                          >
                            <i class="icon-base bx bx-edit icon-sm me-1_5"></i>
                            <span class="align-middle">Edit</span>
                          </button>
                        </li>

                      </ul>
                    </div>
                    <div class="tab-content p-0">
                      <!-- Update item/tasks -->
                      <div
                        class="tab-pane fade show active"
                        id="tab-update"
                        role="tabpanel"
                      >
                        <form>
                          <div class="mb-8 mt-2">
                            <label class="form-label" for="title">Title</label>
                            <input
                              type="text"
                              id="title"
                              class="form-control title"
                              placeholder="Enter Title"
                            />
                          </div>
                          <div class="mb-8">
                            <label class="form-label" for="due-date"
                              >Due Date</label
                            >
                            <input
                              type="text"
                              id="due-date"
                              class="form-control"
                              placeholder="Enter Due Date"
                            />
                          </div>
                          <div class="mb-8">
                            <label class="form-label" for="label"> Label</label>
                            <select
                              class="select2 select2-label form-select"
                              id="label"
                            >
                              <option data-color="bg-label-success" value="UX">
                                UX
                              </option>
                              <option
                                data-color="bg-label-warning"
                                value="Images"
                              >
                                Images
                              </option>
                              <option data-color="bg-label-info" value="Info">
                                Info
                              </option>
                              <option
                                data-color="bg-label-danger"
                                value="Code Review"
                              >
                                Code Review
                              </option>
                              <option
                                data-color="bg-label-secondary"
                                value="App"
                              >
                                App
                              </option>
                              <option
                                data-color="bg-label-primary"
                                value="Charts & Maps"
                              >
                                Charts & Maps
                              </option>
                            </select>
                          </div>
                          <div class="mb-6">
                            <label class="form-label">Assigned</label>
                            <div class="assigned d-flex flex-wrap"></div>
                          </div>
                          <div class="mb-6">
                            <label class="form-label" for="attachments"
                              >Attachments</label
                            >
                            <div>
                              <input
                                type="file"
                                class="form-control"
                                id="attachments"
                              />
                            </div>
                          </div>
                          <div class="mb-6">
                            <label class="form-label">Comment</label>
                            <div class="comment-editor border-bottom-0"></div>
                            <div class="d-flex justify-content-end">
                              <div class="comment-toolbar">
                                <span class="ql-formats me-0">
                                  <button class="ql-bold"></button>
                                  <button class="ql-italic"></button>
                                  <button class="ql-underline"></button>
                                  <button class="ql-link"></button>
                                  <button class="ql-image"></button>
                                </span>
                              </div>
                            </div>
                          </div>
                          <div>
                            <div class="d-flex flex-wrap">
                              <button
                                type="button"
                                class="btn btn-primary me-4"
                                data-bs-dismiss="offcanvas"
                                onclick="handleEditKanban(event)"
                              >
                                Update
                              </button>
                              <button
                                type="button"
                                class="btn btn-label-danger"
                                data-bs-dismiss="offcanvas"
                              >
                                Delete
                              </button>
                            </div>
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- / Content -->


            <div class="content-backdrop fade"></div>
          </div>
          <!-- Content wrapper -->
        </div>
        <!-- / Layout page -->
      </div>

      <!-- Overlay -->
      <div class="layout-overlay layout-menu-toggle"></div>

      <!-- Drag Target Area To SlideIn Menu On Small Screens -->
      <div class="drag-target"></div>
    </div>

    <script>
      const handleEditKanban = async (e) => {
    e.preventDefault();

    // Get input values safely
    const title = document.querySelector('.title')?.value || "";
    const due_date = document.getElementById('due-date')?.value || "";
    const label = document.getElementById('label')?.value || "";
    const attachments = document.getElementById('attachments');
    const commentEditorContent = document.querySelector('.ql-editor')?.innerHTML || "";
    const card_id=document.querySelector('.kanban-update-item-sidebar')?.getAttribute('data-eid') || "";


    let file = null;
    const formData = new FormData();


    if (attachments && attachments.files.length > 0) {
        file = attachments.files[0];  
    }
    if (file) {
    formData.append("attachment", file);  // Append the first file
}
    formData.append("title", title);
    formData.append("due_date", due_date);
    formData.append("label", label);
    formData.append("comment", commentEditorContent);
    formData.append("card_id", card_id);


    console.log(formData)

    // Example: Sending data to an API
    try {
        const response = await fetch("http://127.0.0.1:8000/update_kanban_board", {
            method: "POST",
            body: formData,
        });

        const result = await response.json();
        console.log("Response:", result);
    } catch (error) {
        console.error("Error:", error);
    }
};

    </script>



    <script src="assets/vendor/libs/jquery/jquery.js"></script>

    <script src="assets/vendor/libs/popper/popper.js"></script>
    <script src="assets/vendor/js/bootstrap.js"></script>

    <script src="assets/vendor/libs/pickr/pickr.js"></script>

    <script src="assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>



    <script src="assets/vendor/js/menu.js"></script>

    <!-- endbuild -->

    <!-- Vendors JS -->
    <script src="assets/vendor/libs/moment/moment.js"></script>
    <script src="assets/vendor/libs/flatpickr/flatpickr.js"></script>
    <script src="assets/vendor/libs/select2/select2.js"></script>
    <script src="assets/vendor/libs/jkanban/jkanban.js"></script>
    <script src="assets/vendor/libs/quill/katex.js"></script>
    <script src="assets/vendor/libs/quill/quill.js"></script>

    <!-- Main JS -->


    <!-- Page JS -->
    <script src="assets/js/app-kanban.js"></script>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="assets/js/vendor/jquery-3.7.0.js"></script>
    <script src="assets/js/vendor/isotope.pkgd.js"></script>
    <script src="assets/js/vendor/bootstrap.bundle.min.js"></script>
    <script src="assets/js/vendor/magnific-popup.min.js"></script>
    <script src="assets/js/vendor/ajax-form.js"></script>
    <script src="assets/js/vendor/jquery.repeater.js"></script>
    <script src="assets/js/plugins/waypoints.min.js"></script>
    <script src="assets/js/plugins/dayjs.min.js"></script>
    <script src="assets/js/plugins/loader.js"></script>
    <script src="assets/js/plugins/jsvectormap.min.js"></script>
    <script src="assets/js/plugins/world-merc.js"></script>
    <script src="assets/js/plugins/swiper-bundle.min.js"></script>
    <script src="assets/js/plugins/popper.min.js"></script>
    <script src="assets/js/plugins/simplebar.min.js"></script>
    <script src="assets/js/plugins/simplebar-active.js"></script>
    <script src="assets/js/plugins/backtotop.js"></script>
    <script src="assets/js/plugins/smooth-scrollbar.js"></script>
    <script src="assets/js/plugins/cleave.min.js"></script>
    <script src="assets/js/plugins/datatables.min.js"></script>
    <script src="assets/js/plugins/jquery.dataTables.min.js"></script>
    <script src="assets/js/plugins/dataTables.bootstrap5.min.js"></script>
    <script src="assets/js/plugins/dataTables.buttons.min.js"></script>
    <script src="assets/js/plugins/jszip.min.js"></script>
    <script src="assets/js/plugins/pdfmake.min.js"></script>
    <script src="assets/js/plugins/vfs_fonts.js"></script>
    <script src="assets/js/plugins/buttons.html5.min.js"></script>
    <script src="assets/js/plugins/buttons.print.min.js"></script>
    <script src="assets/js/plugins/buttons.colVis.min.js"></script>
    <script src="assets/js/plugins/steps-form.js"></script>
    <script src="assets/js/plugins/dropify.min.js"></script>
    <script src="assets/js/plugins/dropzone.js"></script>
    <script src="assets/js/plugins/tinymce.min.js"></script>
    <script src="assets/js/plugins/custom.js"></script>
    <script src="assets/js/plugins/typeahead.bundle.min.js"></script>
    <script src="assets/js/plugins/bloodhound.js"></script>
    <script src="assets/js/plugins/select2.full.min.js"></script>
    <script src="assets/js/plugins/jquery.timepicker.min.js"></script>
    <script src="assets/js/plugins/flatpickr.js"></script>
    <script src="assets/js/plugins/tagify.js"></script>
    <script src="assets/js/plugins/jquery-ui.min.js"></script>
    <script src="assets/js/plugins/sweetalert2.all.min.js"></script>
    <script src="assets/js/plugins/apexcharts.min.js"></script>
    <script src="assets/js/plugins/fullcalendar.min.js"></script>
    <script src="assets/js/plugins/ion.rangeSlider.min.js"></script>
    <script src="assets/js/vendor/custom-tagify.js"></script>
    <script src="assets/js/vendor/height-equal.js"></script>
    <script src="assets/js/vendor/rangeslider-script.js"></script>
    <script src="assets/js/vendor/jquery.barrating.js"></script>
    <script src="assets/js/vendor/rating-script.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/vendor/sidebar.js"></script>
  </body>
</html>

<!-- beautify ignore:end -->
